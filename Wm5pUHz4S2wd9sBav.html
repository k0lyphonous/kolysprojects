<html><head><base href="https://example.com"></base><style>
    body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #1B2A49;
        overflow: hidden;
    }

    .game-container {
        width: 100vw;
        height: 100vh;
        position: relative;
    }

    .character {
        width: 50px;
        height: 50px;
        position: absolute;
        transition: transform 0.1s;
        cursor: pointer;
    }

    .platform {
        position: absolute;
        background: linear-gradient(45deg, #465881, #2E3B5C);
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .kill-brick {
        position: absolute;
        background: linear-gradient(45deg, #ff0000, #cc0000);
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        height: 20px;
    }

    .coin {
        width: 30px;
        height: 30px;
        position: absolute;
        animation: float 2s infinite ease-in-out;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    .score {
        position: fixed;
        top: 20px;
        right: 20px;
        color: #FFD700;
        font-size: 24px;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .health-bar {
        position: fixed;
        top: 20px;
        left: 20px;
        width: 200px;
        height: 20px;
        background: #333;
        border-radius: 10px;
        overflow: hidden;
        display: flex;           
        align-items: center;     
        justify-content: center; 
    }

    .health-fill {
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, #ff3e3e, #ff7f7f);
        transition: width 0.3s;
    }

    .time-text {
        position: absolute;
        color: white;
        font-size: 12px;
        font-weight: bold;
        z-index: 1;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        pointer-events: none;
    }

    .level-transition {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #FFD700;
        font-size: 36px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        opacity: 0;
        transition: opacity 0.5s;
    }
</style></head><body>
    <div class="game-container">
        <div class="score">Level: <span id="levelCount">1</span> | Coins: <span id="coinCount">0</span></div>
        <div class="health-bar">
            <div class="health-fill" id="healthFill"></div>
            <div class="time-text" id="timeText">TIME LEFT: 100</div>
        </div>
        <div class="level-transition" id="levelTransition">Level Complete!</div>
    </div>

<script>
class Game {
    constructor() {
        this.container = document.querySelector('.game-container');
        this.character = this.createCharacter();
        this.platforms = [];
        this.killBricks = [];
        this.coins = [];
        this.score = 0;
        this.health = 100;
        this.velocity = { x: 0, y: 0 };
        this.gravity = 0.5;
        this.jumping = false;
        this.keys = {};
        this.currentLevel = 1;
        this.levelTransition = document.getElementById('levelTransition');
        
        // New audio context setup
        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        this.createLevel();
        this.setupEventListeners();
        this.gameLoop();
    }

    createCharacter() {
        const character = document.createElement('div');
        character.className = 'character';
        character.innerHTML = `
            <svg viewBox="0 0 50 50" width="50" height="50">
                <rect x="10" y="10" width="30" height="30" rx="5" fill="#FF4D4D"/>
                <circle cx="20" cy="25" r="3" fill="#FFF"/>
                <circle cx="30" cy="25" r="3" fill="#FFF"/>
                <path d="M20 32 Q25 37 30 32" stroke="#FFF" fill="none" stroke-width="2"/>
            </svg>
        `;
        character.style.left = '100px';
        character.style.top = '100px';
        this.container.appendChild(character);
        return character;
    }

    generateLevel() {
        const levelData = {
            platforms: [],
            coins: [],
            killBricks: []
        };

        const platformCount = Math.min(3 + Math.floor(this.currentLevel * 1.5), 10);

        for (let i = 0; i < platformCount - 1; i++) {
            const platform = {
                x: Math.random() * (window.innerWidth - 200),
                y: 100 + (i * (400 / platformCount)),
                width: 150 + Math.random() * 100,
                height: 20,
                hasKillBrick: Math.random() < 0.3
            };
            levelData.platforms.push(platform);

            if (platform.hasKillBrick) {
                levelData.killBricks.push({
                    x: platform.x + platform.width / 4,
                    y: platform.y - 20,
                    width: platform.width / 2
                });
            }
        }

        levelData.platforms.push({
            x: 0,
            y: 500,
            width: window.innerWidth,
            height: 20,
            hasKillBrick: false
        });

        for (let i = 0; i < platformCount - 1; i++) {
            const platform = levelData.platforms[i];
            if (!platform.hasKillBrick) {
                levelData.coins.push({
                    x: platform.x + Math.random() * (platform.width - 30),
                    y: platform.y - 80
                });
            }
        }

        return levelData;
    }

    resetToLevel1() {
        this.playDeathSound();
        this.currentLevel = 1;
        document.getElementById('levelCount').textContent = this.currentLevel;
        this.score = 0;
        document.getElementById('coinCount').textContent = this.score;
        this.health = 100;
        document.getElementById('healthFill').style.width = '100%';
        document.getElementById('timeText').textContent = `TIME LEFT: ${Math.round(this.health)}`;
        this.createLevel();
    }

    createLevel() {
        this.platforms.forEach(platform => platform.remove());
        this.killBricks.forEach(brick => brick.remove());
        this.coins.forEach(coin => coin && coin.remove());
        this.platforms = [];
        this.killBricks = [];
        this.coins = [];

        const levelData = this.generateLevel();

        levelData.platforms.forEach(pos => {
            const platform = document.createElement('div');
            platform.className = 'platform';
            platform.style.left = `${pos.x}px`;
            platform.style.top = `${pos.y}px`;
            platform.style.width = `${pos.width}px`;
            platform.style.height = `${pos.height}px`;
            this.container.appendChild(platform);
            this.platforms.push(platform);
        });

        levelData.killBricks.forEach(pos => {
            const killBrick = document.createElement('div');
            killBrick.className = 'kill-brick';
            killBrick.style.left = `${pos.x}px`;
            killBrick.style.top = `${pos.y}px`;
            killBrick.style.width = `${pos.width}px`;
            this.container.appendChild(killBrick);
            this.killBricks.push(killBrick);
        });

        levelData.coins.forEach(pos => {
            const coin = document.createElement('div');
            coin.className = 'coin';
            coin.innerHTML = `
                <svg viewBox="0 0 30 30" width="30" height="30">
                    <circle cx="15" cy="15" r="12" fill="#FFD700"/>
                    <text x="15" y="20" text-anchor="middle" fill="#B8860B" font-size="14">$</text>
                </svg>
            `;
            coin.style.left = `${pos.x}px`;
            coin.style.top = `${pos.y}px`;
            this.container.appendChild(coin);
            this.coins.push(coin);
        });

        this.character.style.left = '100px';
        this.character.style.top = '100px';
        this.velocity = { x: 0, y: 0 };
    }

    setupEventListeners() {
        window.addEventListener('keydown', e => this.keys[e.key] = true);
        window.addEventListener('keyup', e => this.keys[e.key] = false);
    }

    async nextLevel() {
        this.levelTransition.style.opacity = '1';
        await new Promise(resolve => setTimeout(resolve, 1500));
        this.levelTransition.style.opacity = '0';
        this.currentLevel++;
        document.getElementById('levelCount').textContent = this.currentLevel;
        this.createLevel();
    }

    playCoinSound() {
        const oscillator = this.audioContext.createOscillator();
        const gainNode = this.audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.audioContext.destination);
        
        oscillator.type = 'sine';
        oscillator.frequency.setValueAtTime(880, this.audioContext.currentTime); // A5
        oscillator.frequency.setValueAtTime(1320, this.audioContext.currentTime + 0.1); // E6
        
        gainNode.gain.setValueAtTime(0.2, this.audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.2);
        
        oscillator.start();
        oscillator.stop(this.audioContext.currentTime + 0.2);
    }

    playDeathSound() {
        const oscillator = this.audioContext.createOscillator();
        const gainNode = this.audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.audioContext.destination);
        
        oscillator.type = 'square';
        oscillator.frequency.setValueAtTime(440, this.audioContext.currentTime); // A4
        oscillator.frequency.setValueAtTime(220, this.audioContext.currentTime + 0.1); // A3
        
        gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.3);
        
        oscillator.start();
        oscillator.stop(this.audioContext.currentTime + 0.3);
    }

    update() {
        if (this.keys['ArrowLeft']) this.velocity.x = -5;
        else if (this.keys['ArrowRight']) this.velocity.x = 5;
        else this.velocity.x *= 0.8;

        if (this.keys['ArrowUp'] && !this.jumping) {
            this.velocity.y = -15;
            this.jumping = true;
        }

        this.velocity.y += this.gravity;

        let newX = this.character.offsetLeft + this.velocity.x;
        let newY = this.character.offsetTop + this.velocity.y;

        this.killBricks.forEach(killBrick => {
            if (this.checkCollision(
                this.character.getBoundingClientRect(),
                killBrick.getBoundingClientRect()
            )) {
                this.resetToLevel1();
                return;
            }
        });

        this.platforms.forEach(platform => {
            const platformRect = platform.getBoundingClientRect();
            const characterRect = this.character.getBoundingClientRect();

            if (this.checkCollision(characterRect, platformRect)) {
                if (this.velocity.y > 0 && characterRect.bottom <= platformRect.top + this.velocity.y) {
                    newY = platformRect.top - characterRect.height;
                    this.velocity.y = 0;
                    this.jumping = false;
                }
            }
        });

        let remainingCoins = 0;
        this.coins.forEach((coin, index) => {
            if (coin !== null) {
                remainingCoins++;
                if (this.checkCollision(
                    this.character.getBoundingClientRect(),
                    coin.getBoundingClientRect()
                )) {
                    this.playCoinSound();
                    coin.remove();
                    this.coins[index] = null;
                    this.score += 1;
                    document.getElementById('coinCount').textContent = this.score;
                }
            }
        });

        if (remainingCoins === 0) {
            this.nextLevel();
        }

        this.health = Math.max(0, this.health - 0.1);
        document.getElementById('healthFill').style.width = `${this.health}%`;
        document.getElementById('timeText').textContent = `TIME LEFT: ${Math.round(this.health)}`;

        if (this.health <= 0) {
            this.resetToLevel1();
            this.health = 100;
            return;
        }

        this.character.style.left = `${newX}px`;
        this.character.style.top = `${newY}px`;
    }

    checkCollision(rect1, rect2) {
        return !(rect1.right < rect2.left || 
                rect1.left > rect2.right || 
                rect1.bottom < rect2.top || 
                rect1.top > rect2.bottom);
    }

    gameLoop() {
        this.update();
        requestAnimationFrame(() => this.gameLoop());
    }
}

const game = new Game();
</script></body></html>